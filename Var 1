using System;
using System.Collections.Generic;
using System.Collections.Specialized;
using System.Data.SqlTypes;
using System.Globalization;
using System.IO;
using System.Linq;
using System.Security.Cryptography;
using System.Text;
using System.Threading;
using System.Threading.Tasks;

namespace Lab4
{
    internal class Program
    {
        static Random random = new Random();

        //интерфейс
        static void PrintMenu(string[] menu)
        {
            int index = 1;
            foreach (string item in menu)
            {
                Console.WriteLine($"{index++}) {item}");
            }
        }
        static int ReadInt(string message = "Введите целое число ", string errorMessage = "Ошибка ввода целого числа!", string errorMessageLine = "Ваше число слишком большое/малое" ,int min = int.MinValue, int max = int.MaxValue)
        {
            bool isConvert;
            int number;
            do
            {
                Console.Write(message);
                isConvert = int.TryParse(Console.ReadLine(), out number);
                if (!isConvert)
                    Console.WriteLine(errorMessage);
                else if (number < min || number > max)
                {
                    Console.WriteLine(errorMessageLine);
                    isConvert = false;
                }
            } while (!isConvert);
            return number;
        }

        // бизнес-логика
        static int[] CreateArtificialArray(int len)
        {
            int[] arr = new int[len];
            Console.WriteLine("Вводите целые числа вашего массива: ");
            for (int i = 0; i < arr.Length; i++)
            {
                arr[i] = ReadInt("");
            }
            return arr;
        }

        static int[] CreateRandomArray(int len)
        {
            int start = ReadInt("Введите нижнюю границу для ввода случайных чисел: ");
            int end = ReadInt("Введите верхнюю границу для ввода случайных чисел: ");
            if (start > end)
            {
                Console.WriteLine("Большее число станет верхним краем, а меньшее нижним. ");
                (start, end) = (end, start);
            }
            int[] arr = new int[len];
            for (int i = 0; i < len; i++)
            {
                arr[i] = random.Next(start, end);
            }
            return arr;
        }

        static void PrintArray(int[] arr)
        {
            foreach (int item in arr)
            {
                Console.Write($"{item} ");
            }
            Console.WriteLine();
        }

        static int FindMax(int[] arr)
        {
            int max = arr[0];
            for (int i = 1; i < arr.Length; i++)
            {
                if (arr[i] > max)
                {
                    max = arr[i];
                }
            }
            return max;
        }

        static int Even(int[] arr)
        {
            int count = 0;
            for (int i = 0;i < arr.Length; i++)
            {
                if (arr[i] % 2 == 0)
                    count++;        
            }
            return count;
        }

        static void Remove(ref int[] arr)
        {
            int even = Even(arr);
            int[] temp = new int[arr.Length - even];
            int j = 0;
            for (int i = 0; i < arr.Length; i++)
            {
                if (arr[i] % 2 != 0)
                {
                    temp[j] = arr[i];
                    j++;
                }
            }
            arr = temp;

        }

        static void InputArtificialElements(ref int[] arr, int len)
        {
            int[] temp = new int[len + arr.Length];
            int j = 0;
            Console.WriteLine("Вводите целые числа вашего массива: ");
            for (int i = 0; i < temp.Length; i++)
            {
                if (i < len)
                {
                    temp[i] = ReadInt("");
                }
                else
                {
                    temp[i] = arr[j++];
                }
            }
            arr = temp;
        }
            
        static void InputRandomElements(ref int[] arr, int len)
        {
            int[] temp = new int[arr.Length + len];
            int i = 0;
            int start = ReadInt("Введите нижнюю границу для ввода случайных чисел: ");
            int end = ReadInt("Введите верхнюю границу для ввода случайных чисел: ");
            if (start > end)
            {
                Console.WriteLine("Большее число станет верхним краем, а меньшее нижним. ");
                (start, end) = (end, start);
            }
            while (i < temp.Length)
            {
                if (i < len - 1)
                {
                    temp[i] = random.Next(start, end);
                }
                else
                {
                    temp[i] = arr[i];
                }
                i++;
            }
            temp = arr;
        }

        static int[] ReverseArray(int[] arr)
        {
            int left = 0;
            int right = arr.Length - 1;
            while (left < right)
            {
                (arr[left], arr[right]) = (arr[right], arr[left]);
                left++;
                right--;    
            }
            return arr;
        }

        static int FindFirstEven(int[] arr)
        {
            int firstEven = 1;
            for (int i = 0; firstEven % 2 != 0; i++)
            {
                firstEven = arr[i];
            }
            return firstEven;
        }

        static void Main(string[] args)
        {
            string[] menu = { "Формирование массива", "Поиск максимального элемента",
                "Добавление элементов в начало массива", "Переворот массива", "Нахождение первого четного элемента", 
                "Сортировка массива", "Конец работы"};
            int choose = 0;
            int[] arr = new int[0];
            bool isNull;
            do
            {
                PrintMenu(menu);
                choose = ReadInt("Введите номер команды: ", "Ошибка ввода номера команды!","Извините, но команды с таким номером пока нет.", min : 1 , max: menu.Length);
                switch (choose)
                {
                    case 1:
                        string[] insideFirstMenu = { "Создание массива с помощью ввода с клавиатуры",
                            "Создание массива с помощью генерирования случайных чисел"};
                        PrintMenu(insideFirstMenu);
                        int choise1 = ReadInt(message:"Введите номер команды: ",errorMessageLine:"Команды с таким номером нет. " , max: 2, min: 1);
                        switch (choise1)
                        {
                            case 1:
                                int len = ReadInt("Введите длину массива: ", "Ошибка ввода длины массива!");
                                arr = CreateArtificialArray(len);
                                Console.Write("Вот ваш массив: ");
                                PrintArray(arr);
                                break;
                            case 2:
                                int lenn = ReadInt("Введите длину массива: ", "Ошибка ввода длины массива!");
                                arr = CreateRandomArray(lenn);
                                Console.Write("Вот ваш массив: ");
                                PrintArray(arr);
                                break;
                        }
                        break;
                    case 2:
                        isNull = (arr.Length == 0);
                        switch (isNull)
                        {
                            case true:
                                Console.WriteLine("Для начала необходимо создать массив.");
                                break;
                            case false:
                                Console.WriteLine($"Максимальный элемент вашего массива равен {FindMax(arr)}");
                                break;
                        }
                        break;
                    case 3:
                        isNull = (arr.Length == 0);
                        switch (isNull)
                        {
                            case true:
                                Console.WriteLine("Для начала необходимо создать массив.");
                                break;
                            case false:
                                int number = ReadInt("Введите какое количество чисел вы хотите ввести: ", errorMessageLine: "Невозможно ввести такое количество чисел!", min: 1);
                                string[] insideSecondMenu = { "Добавление элементa(ов) вручную", "Добавление случайного элемента(ов)" };
                                PrintMenu(insideSecondMenu);
                                int choise2 = ReadInt(message: "Введите номер команды: ", errorMessageLine: "Команды с таким номером нет.", max: 2, min: 1);
                                switch (choise2)
                                {
                                    case 1:
                                        InputArtificialElements(ref arr, number);
                                        PrintArray(arr);
                                        break;
                                    case 2:
                                        InputRandomElements(ref arr, number);
                                        break;
                                }
                                break;
                        }
                        break;
                    case 4:
                        isNull = (arr.Length == 0);
                        switch (isNull)
                        {
                            case true:
                                Console.WriteLine("Для начала необходимо создать массив.");
                                break;
                            case false:
                                Console.Write("Перевернутый массив: ");
                                PrintArray(ReverseArray(arr));
                                break;
                        }
                        break;
                    case 5:
                        isNull = (arr.Length == 0);
                        switch (isNull)
                        {
                            case true:
                                Console.WriteLine("Для начала необходимо создать массив.");
                                break;
                            case false:
                                Console.WriteLine($"Первым четным элементом массива является: {FindFirstEven(arr)}");
                                break;
                        }
                        break;
                    case 6:
                        isNull = (arr.Length == 0);
                        switch (isNull)
                        {
                            case true:
                                Console.WriteLine("Для начала необходимо создать массив.");
                                break;
                            case false:
                                Console.WriteLine("esche netu");
                                break;
                        }
                        break;
                }
                Console.WriteLine();
            }while (choose != menu.Length);
            Console.WriteLine("Завершаю работу...");


        }
    }
}
